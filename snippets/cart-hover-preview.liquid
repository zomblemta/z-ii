{% comment %}
  Renders cart hover preview for desktop
  
  Usage:
  {% render 'cart-hover-preview' %}
{% endcomment %}

<link rel="stylesheet" href="{{ 'component-cart-hover-preview.css' | asset_url }}">
<script src="{{ 'cart-hover-preview.js' | asset_url }}" defer="defer"></script>

<div id="cart-hover-preview" class="cart-hover-preview" data-cart-hover>
  <div class="cart-hover-preview__container">
    <!-- Header -->
    <div class="cart-hover-preview__header">
      <h3 class="cart-hover-preview__title">IN YOUR CART</h3>
    </div>

    <!-- Cart Items -->
    <div class="cart-hover-preview__items" id="cart-hover-items">
      {%- if cart == empty -%}
        <div class="cart-hover-preview__empty">
          <p>{{ 'sections.cart.empty' | t }}</p>
        </div>
      {%- else -%}
        {%- for item in cart.items limit: 3 -%}
          <div class="cart-hover-preview__item flex gap-[20px]">
            <!-- Product Image -->
            <div class="cart-hover-preview__item-image">
              {% if item.image %}
                <a href="{{ item.url }}">
                  <img
                    src="{{ item.image | image_url: width: 2000 }}"
                    alt="{{ item.image.alt | escape }}"
                    loading="lazy"
                    width="160"
                    height="160"
                  >
                </a>
              {% endif %}
            </div>
            <div class="cart-hover-preview__item-details ">
                <a href="{{ item.url }}" class="cart-hover-preview__item-title">
                  {{ item.product.title | escape }}
                </a>
                
                {%- if item.product.has_only_default_variant == false -%}
                  <div class="cart-hover-preview__item-options">
                    {%- for option in item.options_with_values -%}
                      {%- if option.name == 'Color' or option.name == '颜色' -%}
                        <span class="cart-hover-preview__color-dot"></span>
                        <span class="cart-hover-preview__option-value">{{ option.value }}</span>
                      {%- else -%}
                        <span class="cart-hover-preview__option-value">{{ option.value }}</span>
                      {%- endif -%}
                    {%- endfor -%}
                  </div>
                {%- endif -%}
  
                <div class="cart-hover-preview__item-meta">
                  <span class="cart-hover-preview__quantity">Quantity: {{ item.quantity }}</span>
                  <span class="cart-hover-preview__price">{{ item.final_line_price | money }}</span>
                </div>
              </div>

            <!-- Product Details -->
     
          </div>
        {%- endfor -%}
        
        {%- if cart.item_count > 3 -%}
          <div class="cart-hover-preview__more-items">
            +{{ cart.item_count | minus: 3 }} more item(s)
          </div>
        {%- endif -%}
      {%- endif -%}
    </div>

    {%- if cart != empty -%}
      <!-- Footer -->
      <div class="cart-hover-preview__footer">
        <div class="cart-hover-preview__total">
          <span class="cart-hover-preview__total-label">Total:</span>
          <span class="cart-hover-preview__total-price">{{ cart.total_price | money }}</span>
        </div>
        <button type="button" class="cart-hover-preview__view-cart" data-open-cart-drawer>
          VIEW MY CART
        </button>
      </div>
    {%- endif -%}
  </div>
</div>

